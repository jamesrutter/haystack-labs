---
import Layout from "@/layouts/Layout.astro";
import { getCollection } from "astro:content";

export async function getStaticPaths() {
  const resources = await getCollection("resources");
  return resources.map((resource) => ({
    params: { resource: resource.slug },
    props: { resource },
  }));
}

const { resource } = Astro.props;
const { Content } = await resource.render();
---

<Layout
  title={`${resource.data.title} - Haystack Labs`}
  description={resource.data.description}
>
  <section class="section">
    <div class="wrapper">
      <header style="margin-bottom: var(--space-3xl);">
        <h1 class="text-inverse">{resource.data.title}</h1>
        <p class="description">{resource.data.description}</p>
        
        <div class="grid grid--3col" style="margin-top: var(--space-2xl);">
          <div class="card">
            <h3>Type</h3>
            <p class="stat-number" style="font-size: var(--font-size-lg);">
              {resource.data.type}
            </p>
          </div>
          
          {resource.data.difficulty && (
            <div class="card">
              <h3>Difficulty</h3>
              <p class="stat-number" style="font-size: var(--font-size-lg);">
                {resource.data.difficulty}
              </p>
            </div>
          )}
          
          {resource.data.author && (
            <div class="card">
              <h3>Author</h3>
              <p class="stat-number" style="font-size: var(--font-size-lg);">
                {resource.data.author}
              </p>
            </div>
          )}
        </div>
        
        {resource.data.tags && (
          <div style="margin-top: var(--space-xl);">
            <strong>Tags:</strong>
            {resource.data.tags.map((tag) => (
              <span style="background: var(--color-secondary); color: white; padding: 0.25rem 0.5rem; margin: 0.25rem; border-radius: 0.25rem; font-size: 0.8rem; display: inline-block;">
                {tag}
              </span>
            ))}
          </div>
        )}
        
        {resource.data.links && (
          <div class="actions" style="margin-top: var(--space-2xl);">
            {resource.data.links.github && (
              <a href={resource.data.links.github} target="_blank" class="btn btn-primary">
                View on GitHub
              </a>
            )}
            {resource.data.links.website && (
              <a href={resource.data.links.website} target="_blank" class="btn btn-secondary">
                Visit Website
              </a>
            )}
            {resource.data.links.download && (
              <a href={resource.data.links.download} target="_blank" class="btn btn-secondary">
                Download
              </a>
            )}
          </div>
        )}
      </header>

      <div class="content">
        <Content />
      </div>
    </div>
  </section>
</Layout>