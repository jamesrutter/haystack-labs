---
import Layout from "@/layouts/layout.astro";
import { getCollection, render } from "astro:content";

export async function getStaticPaths() {
  const participants = await getCollection("participants");
  return participants.map((participant) => ({
    params: { participant: participant.id },
    props: { participant },
  }));
}

const { participant } = Astro.props;
const { Content } = await render(participant);
---

<Layout
  title={`${participant.data.name} - Haystack Labs`}
  description={participant.data.bio || `Profile of ${participant.data.name}`}
>
  <section class="section">
    <div class="wrapper">
      <header style="margin-bottom: var(--space-3xl);">
        <h1 class="text-inverse">{participant.data.name}</h1>
        {
          participant.data.title && (
            <p class="subtitle">{participant.data.title}</p>
          )
        }
        {
          participant.data.bio && (
            <p class="description">{participant.data.bio}</p>
          )
        }

        <div class="grid grid--3col" style="margin-top: var(--space-2xl);">
          {
            participant.data.expertise && (
              <div class="card">
                <h3>Expertise</h3>
                <ul>
                  {participant.data.expertise.map((skill: string) => (
                    <li>{skill}</li>
                  ))}
                </ul>
              </div>
            )
          }

          {
            participant.data.social && (
              <div class="card">
                <h3>Connect</h3>
                <ul style="list-style: none; padding: 0;">
                  {participant.data.website && (
                    <li>
                      <a href={participant.data.website} target="_blank">
                        Website
                      </a>
                    </li>
                  )}
                  {participant.data.social.github && (
                    <li>
                      <a
                        href={`https://github.com/${participant.data.social.github}`}
                        target="_blank"
                      >
                        GitHub
                      </a>
                    </li>
                  )}
                  {participant.data.social.twitter && (
                    <li>
                      <a
                        href={`https://twitter.com/${participant.data.social.twitter}`}
                        target="_blank"
                      >
                        Twitter
                      </a>
                    </li>
                  )}
                  {participant.data.social.instagram && (
                    <li>
                      <a
                        href={`https://instagram.com/${participant.data.social.instagram}`}
                        target="_blank"
                      >
                        Instagram
                      </a>
                    </li>
                  )}
                  {participant.data.social.linkedin && (
                    <li>
                      <a
                        href={`https://linkedin.com/in/${participant.data.social.linkedin}`}
                        target="_blank"
                      >
                        LinkedIn
                      </a>
                    </li>
                  )}
                </ul>
              </div>
            )
          }

          <div class="card">
            <h3>Program Year</h3>
            <p class="stat-number">{participant.data.year}</p>
          </div>
        </div>
      </header>

      <div class="content">
        <Content />
      </div>
    </div>
  </section>
</Layout>
