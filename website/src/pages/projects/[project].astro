---
import Layout from "@/layouts/layout.astro";
import { getCollection, render } from "astro:content";

export async function getStaticPaths() {
  const projects = await getCollection("projects");
  return projects.map((project) => ({
    params: { project: project.id },
    props: { project },
  }));
}

const { project } = Astro.props;
const { Content } = await render(project);
---

<Layout
  title={`${project.data.title} - Haystack Labs`}
  description={project.data.description}
>
  <section class="section">
    <div class="wrapper">
      <header style="margin-bottom: var(--space-3xl);">
        <h1 class="text-inverse">{project.data.title}</h1>
        <p class="description">{project.data.description}</p>

        <div class="grid grid--3col" style="margin-top: var(--space-2xl);">
          <div class="card">
            <h3>Status</h3>
            <p class="stat-number" style="font-size: var(--font-size-lg);">
              {project.data.status || "Unknown"}
            </p>
          </div>

          <div class="card">
            <h3>Year</h3>
            <p class="stat-number">{project.data.year}</p>
          </div>

          {
            project.data.participants && (
              <div class="card">
                <h3>Participants</h3>
                <ul>
                  {project.data.participants.map((participant) => (
                    <li>
                      <a href={`/participants/${participant}`}>{participant}</a>
                    </li>
                  ))}
                </ul>
              </div>
            )
          }
        </div>

        {
          project.data.tags && (
            <div style="margin-top: var(--space-xl);">
              <strong>Tags:</strong>
              {project.data.tags.map((tag) => (
                <span style="background: var(--color-primary); color: white; padding: 0.25rem 0.5rem; margin: 0.25rem; border-radius: 0.25rem; font-size: 0.8rem; display: inline-block;">
                  {tag}
                </span>
              ))}
            </div>
          )
        }

        {
          project.data.links && (
            <div class="actions" style="margin-top: var(--space-2xl);">
              {project.data.links.github && (
                <a
                  href={project.data.links.github}
                  target="_blank"
                  class="btn btn-primary"
                >
                  View on GitHub
                </a>
              )}
              {project.data.links.website && (
                <a
                  href={project.data.links.website}
                  target="_blank"
                  class="btn btn-secondary"
                >
                  Visit Website
                </a>
              )}
              {project.data.links.documentation && (
                <a
                  href={project.data.links.documentation}
                  target="_blank"
                  class="btn btn-secondary"
                >
                  View Documentation
                </a>
              )}
            </div>
          )
        }
      </header>

      <div class="content">
        <Content />
      </div>
    </div>
  </section>
</Layout>
